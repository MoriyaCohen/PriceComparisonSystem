<!-- src/app/features/price-results/price-results.component.html -->

<div class="price-results-container" *ngIf="priceDetails && priceDetails.length > 0">

  <!-- 转专转 拽专转 -->
  <div class="results-header">
    <div class="header-info">
      <h3 class="results-title">砖转 专</h3>
      <p class="results-summary">爪 {{ filteredResults.length }} 转爪转 转 {{ priceDetails.length }}</p>
    </div>

    <!-- 拽专转  住 -->
    <div class="controls-section">

      <!--  -->
      <div class="control-group">
        <label for="sort-select" class="control-label"> 驻:</label>
        <select 
          id="sort-select"
          [(ngModel)]="currentSort" 
          (ngModelChange)="onSortChange($event)"
          class="form-select"
        >
          <option *ngFor="let option of sortOptions" [value]="option.value">
            {{ option.label }}
          </option>
        </select>
      </div>

      <!-- 住 驻 专砖转 -->
      <div class="control-group">
        <label for="chain-select" class="control-label">专砖转:</label>
        <select 
          id="chain-select"
          [(ngModel)]="selectedChain" 
          (ngModelChange)="onChainFilter($event)"
          class="form-select"
        >
          <option value="all"> 专砖转转</option>
          <option *ngFor="let chain of availableChains" [value]="chain">
            {{ chain }}
          </option>
        </select>
      </div>

      <!-- 住 专  -->
      <div class="control-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            [(ngModel)]="showOnlyMinPrice"
            (ngModelChange)="toggleMinPriceOnly()"
            class="form-checkbox"
          />
          <span class="checkbox-text">爪 专拽 专  转专</span>
        </label>
      </div>
    </div>
  </div>

  <!-- 专砖转 转爪转 -->
  <div class="results-list">

    <!-- 注   转爪转 住转 -->
    <div *ngIf="filteredResults.length === 0" class="no-results-message">
      <svg class="icon icon-info" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <p> 爪 转爪转 注专 住 专</p>
    </div>

    <!-- 专砖转 专 -->
    <div class="price-items">
      <div 
        *ngFor="let item of filteredResults; trackBy: trackByStore"
        class="price-item"
        [class.min-price]="item['isMinPrice']"
      >

        <!-- 驻专 住祝 -->
        <div class="store-info">
          <div class="store-header">
            <h4 class="store-name">{{ item.storeName }}</h4>
            <span class="chain-name">{{ item.chainName }}</span>
          </div>
          <p class="store-address">{{ item.storeAddress }}</p>
        </div>

        <!-- 注 注 专 -->
        <div class="price-info">
          <div class="price-display">
            <span class="price-amount">{{ item.currentPrice | number:'1.2-2' }}</span>
          </div>

          <!-- 拽专 专  转专 -->
          <div *ngIf="item['isMinPrice']" class="min-price-badge">
            <svg class="icon icon-star" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
            <span> 转专</span>
          </div>

          <!-- 爪转 住 驻砖专 -->
          <div 
            *ngIf="!item['isMinPrice'] && calculateSavings(item.currentPrice) > 0" 
            class="savings-info"
          >
            <span class="savings-amount">+{{ calculateSavings(item.currentPrice) | number:'1.2-2' }}</span>
            <span class="savings-label">转专 拽专</span>
          </div>
        </div>

        <!-- 注 住祝 -->
        <div class="additional-info">
          <div class="last-updated">
            <svg class="icon icon-clock" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <span>注: {{ formatDate(item.lastUpdated) }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 注 住祝 注 转爪转 -->
  <div class="results-footer">
    <div class="footer-info">
      <p class="disclaimer">
        * 专 注 驻  专 专砖转转. 转 砖 专 驻注.
      </p>
      <p class="tip">
         <strong>驻:</strong> 专  砖转转  住驻 转 专砖转. 抓  专 驻 专砖.
      </p>
    </div>
  </div>
</div>